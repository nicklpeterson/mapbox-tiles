(this["webpackJsonpmapbox-tiles"]=this["webpackJsonpmapbox-tiles"]||[]).push([[0],{115:function(e,t,o){},116:function(e,t,o){},161:function(e,t,o){"use strict";o.r(t);var a=o(0),n=o.n(a),l=o(17),r=o.n(l),c=(o(115),o(116),o(13)),s=o.n(c),i=o(65),d=o(86),u=o.n(d),b=(o(122),o(87)),j=o.n(b),O=o(238),p=o(233),g=o(14),h=o(47),x=o(51),m=o(89),v=o.n(m),C=o(95);const S=Object({NODE_ENV:"production",PUBLIC_URL:"/mapbox-tiles",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_BASE_MAPBOX_URL,f=Object({NODE_ENV:"production",PUBLIC_URL:"/mapbox-tiles",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_MAPBOX_API_ACCESS_TOKEN,y=(e,t,o,a)=>256===t||512===t?"".concat(S,"/").concat(e,"/tiles/").concat(t,"/").concat(o,"/").concat(a.x,"/").concat(a.y,"?access_token=").concat(f):"".concat(S,"/").concat(e,"/tiles/512/").concat(o,"/").concat(a.x,"/").concat(a.y,"@2x?access_token=").concat(f),w=Object(h.b)("form/fetchTiles",(async(e,t)=>{const o=t.getState().form;console.info("Downloading ".concat(e.tiles.length," tiles"));const a=await Promise.allSettled(e.tiles.map((t=>v()({url:y(e.style,o.pixels,e.zoom,t),method:"GET",responseType:"blob"}).then((e=>new Promise(((t,o)=>{const a="mapbox-tile-".concat(Object(C.a)(10),".jpg"),n=window.URL.createObjectURL(new Blob([e.data])),l=document.createElement("a");l.href=n,l.setAttribute("download",a),document.body.appendChild(l),l.click(),o()})))))));return a.forEach((e=>{console.log(e)})),t.dispatch(E()),a})),T=Object(h.c)({name:"form",initialState:{upperLeftCoordinate:{lat:null,lon:null},lowerRightCoordinate:{lat:null,lon:null},zoomLevel:8,loading:!1,mapStyle:"satellite-streets-v11",pixels:512,error:null},reducers:{setLoadingToTrue:e=>{e.loading=!0},setLoadingToFalse:e=>{e.loading=!1},setUpperLeftCoordinate:(e,t)=>{e.upperLeftCoordinate=t.payload},setLowerRightCoordinate:(e,t)=>{e.lowerRightCoordinate=t.payload},setZoomLevel:(e,t)=>{e.zoomLevel=t.payload},setMapStyle:(e,t)=>{e.mapStyle=t.payload},setPixels:(e,t)=>{e.pixels=t.payload},setError:(e,t)=>{e.error=t.payload},clearError:e=>{e.error=null}},extraReducers:e=>{e.addCase(w.fulfilled,((e,t)=>{console.log("SUCCESS")}))}}),{setLoadingToTrue:_,setLoadingToFalse:E,setUpperLeftCoordinate:L,setLowerRightCoordinate:P,setZoomLevel:R,setMapStyle:A,setPixels:D}=T.actions,F=e=>e.form,M=Object(x.a)(F,(e=>e.mapStyle)),k=Object(x.a)(F,(e=>e.upperLeftCoordinate)),U=Object(x.a)(F,(e=>e.lowerRightCoordinate)),B=Object(x.a)(F,(e=>e.zoomLevel)),I=Object(x.a)(F,(e=>e.pixels)),N=Object(x.a)(F,(e=>e.loading));var K=T.reducer,H=o(71),W=o(2);s.a.workerClass=o(153).default;const z=[-93.16534986838542,44.96687220057306],q=Object(i.default)({accessToken:Object({NODE_ENV:"production",PUBLIC_URL:"/mapbox-tiles",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_MAPBOX_API_ACCESS_TOKEN}),V=()=>{const e=Object(g.c)(M),t=Object(g.c)(B),o=Object(g.b)();let n=Object(a.useRef)(null);Object(a.useEffect)((()=>{const e=e=>{e.isComposing||"Escape"!==e.key||n.current.draw.deleteAll()};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}}));const l=()=>{const{features:e}=n.current.draw.getAll();if(!e)return[null,null];const t={lat:e[0].geometry.coordinates[0][0][1],lon:e[0].geometry.coordinates[0][0][0]},a={lat:e[0].geometry.coordinates[0][2][1],lon:e[0].geometry.coordinates[0][2][0]};o(L(t)),o(P(a))};return Object(W.jsx)(O.a,{sx:{flexGrow:1},children:Object(W.jsxs)(p.a,{container:!0,spacing:2,children:[Object(W.jsx)(p.a,{item:!0,xs:11,children:Object(W.jsx)("h2",{children:"Mapbox Static Tile Downloader"})}),Object(W.jsx)(q,{style:"mapbox://styles/mapbox/".concat(e),containerStyle:{height:"700px",width:"96vw",marginLeft:"2vw",marginBottom:"2vw"},center:z,zoom:[t],children:Object(W.jsx)(u.a,{ref:n,controls:{polygon:!0,trash:!0},displayControlsDefault:!1,onDrawCreate:()=>{const e=n.current.draw.getAll();n.current.draw.getAll().features.length>1&&n.current.draw.delete(e.features[0].id),l()},onDrawUpdate:()=>{l()},onDrawDelete:()=>{o(L({lat:null,lon:null})),o(P({lat:null,lon:null}))},onDrawSelectionChange:()=>{n.current.draw.getSelected().features.length>0&&n.current.draw.changeMode("tx_rect",{featureId:n.current.draw.getSelected().features[0].id,scaleCenter:H.a.Opposite,canRotate:!1})},modes:{draw_polygon:j.a,tx_rect:H.b}})})]})})};var G=o(227),J=o(230),X=o(226),Z=o(231),Q=o(165),Y=o(234),$=o(93),ee=o.n($);const te=e=>{const t=e.lat?String(e.lat):null,o=e.lon?String(e.lon):null;return t&&o?"[ ".concat(parseFloat(t).toFixed(5),", ").concat(parseFloat(o).toFixed(5)," ]"):""},oe=e=>{try{const t=JSON.parse(e);return{lat:t[0],lon:t[1]}}catch(t){return null}},ae=e=>256===e||512===e||1024===e;function ne(e){let{onSubmit:t}=e;const o=Object(g.b)(),n=Object(g.c)(M),l=Object(g.c)(k),r=Object(g.c)(U),c=Object(g.c)(B),s=Object(g.c)(I),i=Object(g.c)(N),[d,u]=Object(a.useState)(te(l)),[b,j]=Object(a.useState)(te(r)),[p,h]=Object(a.useState)(String(s));Object(a.useEffect)((()=>{u(te(l)),j(te(r))}),[l,r]),Object(a.useEffect)((()=>{h(s)}),[s]);return Object(W.jsxs)(a.Fragment,{children:[Object(W.jsxs)(O.a,{component:"form",sx:{"& > :not(style)":{m:1,width:"30ch"}},noValidate:!0,autoComplete:"off",style:{marginTop:"20px"},children:[Object(W.jsx)(G.a,{required:!0,id:"outlined-required",label:"Upper Left Coordinates",value:d,onChange:e=>{u(e.target.value);const t=oe(e.target.value);t&&o(L(t))},error:!oe(d),disabled:i}),Object(W.jsx)(G.a,{required:!0,id:"outlined-required",label:"Lower Right Coordinates",value:b,onChange:e=>{j(e.target.value);const t=oe(e.target.value);t&&o(P(t))},error:!oe(b),disabled:i}),Object(W.jsx)(G.a,{id:"outlined-required",label:"Tile Size in Pixels Squared",value:p,error:!ae(Number.parseFloat(p)),onChange:e=>{h(e.target.value);const t=Number.parseFloat(e.target.value);ae(t)&&o(D(t))},disabled:i}),Object(W.jsxs)(X.a,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:n,onChange:e=>{o(A(e.target.value))},disabled:i,style:{marginTop:"8px"},children:[Object(W.jsx)(Z.a,{value:"streets-v11",children:"streets-v11"}),Object(W.jsx)(Z.a,{value:"outdoors-v11",children:"outdoors-v11"}),Object(W.jsx)(Z.a,{value:"light-v10",children:"light-v10"}),Object(W.jsx)(Z.a,{value:"dark-v10",children:"dark-v10"}),Object(W.jsx)(Z.a,{value:"satellite-v9",children:"satellite-v9"}),Object(W.jsx)(Z.a,{value:"satellite-streets-v11",children:"satellite-streets-v11"}),Object(W.jsx)(Z.a,{value:"navigation-day-v1",children:"navigation-day-v1"}),Object(W.jsx)(Z.a,{value:"navigation-night-v1",children:"navigation-night-v1"})]}),Object(W.jsxs)(O.a,{sx:{width:320},style:{marginLeft:"auto",marginRight:"auto",marginTop:"20px"},children:[Object(W.jsx)(Q.a,{gutterBottom:!0,children:"Tile Zoom Level"}),Object(W.jsx)(J.a,{"aria-label":"slider",defaultValue:8,valueLabelDisplay:"on",min:1,max:17,step:1,style:{marginTop:"45px"},onChange:e=>{o(R(e.target.value))},onClick:()=>{o(R(1)),o(R(c))},disabled:i})]})]}),Object(W.jsx)(Y.a,{variant:"contained",color:"primary",startIcon:Object(W.jsx)(ee.a,{}),onClick:t,style:{marginTop:"45px",marginBottom:"100px"},disabled:i||!ae(s)||!oe(d)||!oe(b),children:"Download Tiles"})]})}var le=o(57),re=(o(159),o(235)),ce=o(241),se=o(239),ie=o(240),de=o(225);function ue(e){let{open:t,onContinue:o,onDecline:a,text:n}=e;return Object(W.jsx)("div",{children:Object(W.jsxs)(re.a,{open:t,onClose:a,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[Object(W.jsx)(de.a,{id:"alert-dialog-title",children:"Use Google's location service?"}),Object(W.jsx)(se.a,{children:Object(W.jsx)(ie.a,{id:"alert-dialog-description",children:n})}),Object(W.jsxs)(ce.a,{children:[Object(W.jsx)(Y.a,{onClick:a,children:"Cancel"}),Object(W.jsx)(Y.a,{onClick:o,autoFocus:!0,children:"Continue"})]})]})})}const be=Math.PI/180;function je(e,t){const o=be*e.lat;console.log(e);const a=Math.pow(2,t);return{x:Math.floor((e.lon+180)/360*a),y:Math.floor((1-Math.log(Math.tan(o)+1/Math.cos(o))/Math.PI)/2*a)}}function Oe(e,t){const o=[];for(let a=e.x;a<=t.x;a++)for(let n=e.y;n<=t.y;n++)o.push({x:a,y:n});return o}const pe="Are you sure you want to continue with download?",ge=()=>{const e=Object(g.b)(),t=Object(g.c)(N),o=Object(g.c)(M),n=Object(g.c)(k),l=Object(g.c)(U),r=Object(g.c)(B),[c,s]=Object(a.useState)(!1),[i,d]=Object(a.useState)(pe),[u,b]=Object(a.useState)(null);return Object(a.useEffect)((()=>{t?le.b.info("Fetching Tiles!",{position:"top-right",hideProgressBar:!0,closeOnClick:!1,pauseOnHover:!0,draggable:!0,autoClose:!1,progress:void 0}):le.b.dismiss()}),[t]),Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(V,{}),Object(W.jsx)(ne,{onSubmit:e=>{const t=function(e,t,o,a){const n=je(e,o),l=je(t,o),r=Math.abs(n.x-l.x)+1,c=Math.abs(n.y-l.y)+1;return{upperLeftCoordinate:n,lowerRightCoordinate:l,zoom:o,xCount:r,yCount:c,style:a,numTiles:r*c,tiles:Oe(n,l)}}(n,l,r,o);t&&(b(t),d("Are you sure you want to download ".concat(t.tiles.length," map tile files?")),s(!0))}}),Object(W.jsx)(le.a,{}),Object(W.jsx)(ue,{onContinue:()=>{s(!1),d(pe),e(_()),e(w(u))},onDecline:()=>{s(!1),d(pe),e(E())},open:c,text:i})]})};var he=function(){return Object(W.jsx)("div",{className:"App",children:Object(W.jsx)(ge,{})})};var xe=e=>{e&&e instanceof Function&&o.e(3).then(o.bind(null,245)).then((t=>{let{getCLS:o,getFID:a,getFCP:n,getLCP:l,getTTFB:r}=t;o(e),a(e),n(e),l(e),r(e)}))},me=o(44);var ve=e=>t=>o=>{console.group(o.type),console.info("dispatching",o);let a=t(o);return console.log("next state",e.getState()),console.groupEnd(),a};const Ce=Object(h.a)({reducer:{form:K},middleware:[me.a,ve]});r.a.render(Object(W.jsx)(n.a.StrictMode,{children:Object(W.jsx)(g.a,{store:Ce,children:Object(W.jsx)(he,{})})}),document.getElementById("root")),xe()}},[[161,1,2]]]);
//# sourceMappingURL=main.ecd16c5a.chunk.js.map