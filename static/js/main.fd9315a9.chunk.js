(this["webpackJsonpmapbox-tiles"]=this["webpackJsonpmapbox-tiles"]||[]).push([[0],{139:function(e,t,a){},140:function(e,t,a){},197:function(e,t,a){"use strict";a.r(t);var o=a(0),n=a.n(o),l=a(20),r=a.n(l),c=(a(139),a(140),a(13)),i=a(16),s=a.n(i),d=a(75),u=a(110),b=a.n(u),j=(a(159),a(111)),p=a.n(j),g=a(274),h=a(269),O=a(17),x=a(55),m=a(61),v=a(112),f=a.n(v),y=a(119);const w="https://api.mapbox.com/styles/v1/mapbox",C="pk.eyJ1IjoiZmFrZXVzZXJnaXRodWIiLCJhIjoiY2pwOGlneGI4MDNnaDN1c2J0eW5zb2ZiNyJ9.mALv0tCpbYUPtzT7YysA2g",L=(e,t,a,o)=>256===t||512===t?"".concat(w,"/").concat(e,"/tiles/").concat(t,"/").concat(a,"/").concat(o.x,"/").concat(o.y,"?access_token=").concat(C):"".concat(w,"/").concat(e,"/tiles/512/").concat(a,"/").concat(o.x,"/").concat(o.y,"@2x?access_token=").concat(C),S=Object(x.b)("form/fetchTiles",(async(e,t)=>{const a=t.getState().form;console.info("Downloading ".concat(e.tiles.length," tiles"));const o=await Promise.allSettled(e.tiles.map((t=>f()({url:L(e.style,a.pixels,e.zoom,t),method:"GET",responseType:"blob"}).then((e=>new Promise(((t,a)=>{const o="mapbox-tile-".concat(Object(y.a)(10),".jpg"),n=window.URL.createObjectURL(new Blob([e.data])),l=document.createElement("a");l.href=n,l.setAttribute("download",o),document.body.appendChild(l),l.click(),a()})))))));return o.forEach((e=>{console.log(e)})),t.dispatch(F()),o})),T=Object(x.c)({name:"form",initialState:{upperLeftCoordinate:{lat:null,lon:null},lowerRightCoordinate:{lat:null,lon:null},zoomLevel:8,loading:!1,mapStyle:"satellite-streets-v11",pixels:512,error:null},reducers:{setLoadingToTrue:e=>{e.loading=!0},setLoadingToFalse:e=>{e.loading=!1},setUpperLeftCoordinate:(e,t)=>{e.upperLeftCoordinate=t.payload},setLowerRightCoordinate:(e,t)=>{e.lowerRightCoordinate=t.payload},setZoomLevel:(e,t)=>{e.zoomLevel=t.payload},setMapStyle:(e,t)=>{e.mapStyle=t.payload},setPixels:(e,t)=>{e.pixels=t.payload},setError:(e,t)=>{e.error=t.payload},clearError:e=>{e.error=null}},extraReducers:e=>{e.addCase(S.fulfilled,((e,t)=>{console.log("SUCCESS")}))}}),{setLoadingToTrue:k,setLoadingToFalse:F,setUpperLeftCoordinate:D,setLowerRightCoordinate:M,setZoomLevel:E,setMapStyle:I,setPixels:R}=T.actions,z=e=>e.form,J=Object(m.a)(z,(e=>e.mapStyle)),A=Object(m.a)(z,(e=>e.upperLeftCoordinate)),P=Object(m.a)(z,(e=>e.lowerRightCoordinate)),Z=Object(m.a)(z,(e=>e.zoomLevel)),N=Object(m.a)(z,(e=>e.pixels)),U=Object(m.a)(z,(e=>e.loading));var B=T.reducer,G=a(81),q=a(2);s.a.workerClass=a(190).default;const X=[-93.16534986838542,44.96687220057306],Y=Object(d.default)({accessToken:"pk.eyJ1IjoiZmFrZXVzZXJnaXRodWIiLCJhIjoiY2pwOGlneGI4MDNnaDN1c2J0eW5zb2ZiNyJ9.mALv0tCpbYUPtzT7YysA2g"}),_=()=>{const e=Object(O.c)(J),t=Object(O.c)(Z),a=Object(O.b)();let n=Object(o.useRef)(null);Object(o.useEffect)((()=>{const e=e=>{e.isComposing||"Escape"!==e.key||n.current.draw.deleteAll()};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}}));const l=()=>{const{features:e}=n.current.draw.getAll();if(!e)return[null,null];const t={lat:e[0].geometry.coordinates[0][0][1],lon:e[0].geometry.coordinates[0][0][0]},o={lat:e[0].geometry.coordinates[0][2][1],lon:e[0].geometry.coordinates[0][2][0]};a(D(t)),a(M(o))};return Object(q.jsx)(g.a,{sx:{flexGrow:1},children:Object(q.jsxs)(h.a,{container:!0,spacing:2,children:[Object(q.jsx)(h.a,{item:!0,xs:11,children:Object(q.jsx)("h2",{children:"Mapbox Static Tile Downloader"})}),Object(q.jsx)(Y,{style:"mapbox://styles/mapbox/".concat(e),containerStyle:{height:"700px",width:"96vw",marginLeft:"2vw",marginBottom:"2vw"},center:X,zoom:[t],children:Object(q.jsx)(b.a,{ref:n,controls:{polygon:!0,trash:!0},displayControlsDefault:!1,onDrawCreate:()=>{const e=n.current.draw.getAll();n.current.draw.getAll().features.length>1&&n.current.draw.delete(e.features[0].id),l()},onDrawUpdate:()=>{l()},onDrawDelete:()=>{a(D({lat:null,lon:null})),a(M({lat:null,lon:null}))},onDrawSelectionChange:()=>{n.current.draw.getSelected().features.length>0&&n.current.draw.changeMode("tx_rect",{featureId:n.current.draw.getSelected().features[0].id,scaleCenter:G.a.Opposite,canRotate:!1})},modes:{draw_polygon:p.a,tx_rect:G.b}})})]})})};var V=a(263),W=a(266),H=a(262),K=a(267),Q=a(201),$=a(270),ee=a(117),te=a.n(ee);const ae=e=>{const t=e.lat?String(e.lat):null,a=e.lon?String(e.lon):null;return t&&a?"[ ".concat(parseFloat(t).toFixed(5),", ").concat(parseFloat(a).toFixed(5)," ]"):""},oe=e=>{try{const t=JSON.parse(e);return{lat:t[0],lon:t[1]}}catch(t){return null}},ne=e=>256===e||512===e||1024===e;function le(e){let{onSubmit:t}=e;const a=Object(O.b)(),n=Object(O.c)(J),l=Object(O.c)(A),r=Object(O.c)(P),c=Object(O.c)(Z),i=Object(O.c)(N),s=Object(O.c)(U),[d,u]=Object(o.useState)(ae(l)),[b,j]=Object(o.useState)(ae(r)),[p,h]=Object(o.useState)(String(i));Object(o.useEffect)((()=>{u(ae(l)),j(ae(r))}),[l,r]),Object(o.useEffect)((()=>{h(i)}),[i]);return Object(q.jsxs)(o.Fragment,{children:[Object(q.jsxs)(g.a,{component:"form",sx:{"& > :not(style)":{m:1,width:"30ch"}},noValidate:!0,autoComplete:"off",style:{marginTop:"20px"},children:[Object(q.jsx)(V.a,{required:!0,id:"outlined-required",label:"Upper Left Coordinates",value:d,onChange:e=>{u(e.target.value);const t=oe(e.target.value);t&&a(D(t))},error:!oe(d),disabled:s}),Object(q.jsx)(V.a,{required:!0,id:"outlined-required",label:"Lower Right Coordinates",value:b,onChange:e=>{j(e.target.value);const t=oe(e.target.value);t&&a(M(t))},error:!oe(b),disabled:s}),Object(q.jsx)(V.a,{id:"outlined-required",label:"Tile Size in Pixels Squared",value:p,error:!ne(Number.parseFloat(p)),onChange:e=>{h(e.target.value);const t=Number.parseFloat(e.target.value);ne(t)&&a(R(t))},disabled:s}),Object(q.jsxs)(H.a,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:n,onChange:e=>{a(I(e.target.value))},disabled:s,style:{marginTop:"8px"},children:[Object(q.jsx)(K.a,{value:"streets-v11",children:"streets-v11"}),Object(q.jsx)(K.a,{value:"outdoors-v11",children:"outdoors-v11"}),Object(q.jsx)(K.a,{value:"light-v10",children:"light-v10"}),Object(q.jsx)(K.a,{value:"dark-v10",children:"dark-v10"}),Object(q.jsx)(K.a,{value:"satellite-v9",children:"satellite-v9"}),Object(q.jsx)(K.a,{value:"satellite-streets-v11",children:"satellite-streets-v11"}),Object(q.jsx)(K.a,{value:"navigation-day-v1",children:"navigation-day-v1"}),Object(q.jsx)(K.a,{value:"navigation-night-v1",children:"navigation-night-v1"})]}),Object(q.jsxs)(g.a,{sx:{width:320},style:{marginLeft:"auto",marginRight:"auto",marginTop:"20px"},children:[Object(q.jsx)(Q.a,{gutterBottom:!0,children:"Tile Zoom Level"}),Object(q.jsx)(W.a,{"aria-label":"slider",defaultValue:8,valueLabelDisplay:"on",min:1,max:17,step:1,style:{marginTop:"45px"},onChange:e=>{a(E(e.target.value))},onClick:()=>{a(E(1)),a(E(c))},disabled:s})]})]}),Object(q.jsx)($.a,{variant:"contained",color:"primary",startIcon:Object(q.jsx)(te.a,{}),onClick:t,style:{marginTop:"45px",marginBottom:"100px"},disabled:s||!ne(i)||!oe(d)||!oe(b),children:"Download Tiles"})]})}var re=a(67),ce=(a(195),a(271)),ie=a(277),se=a(275),de=a(276),ue=a(261);function be(e){var t=e.open,a=e.onContinue,o=e.onDecline,n=e.text;return Object(q.jsx)("div",{children:Object(q.jsxs)(ce.a,{open:t,onClose:o,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[Object(q.jsx)(ue.a,{id:"alert-dialog-title",children:"Use Google's location service?"}),Object(q.jsx)(se.a,{children:Object(q.jsx)(de.a,{id:"alert-dialog-description",children:n})}),Object(q.jsxs)(ie.a,{children:[Object(q.jsx)($.a,{onClick:o,children:"Cancel"}),Object(q.jsx)($.a,{onClick:a,autoFocus:!0,children:"Continue"})]})]})})}var je=Math.PI/180;function pe(e,t){var a=je*e.lat;console.log(e);var o=Math.pow(2,t);return{x:Math.floor((e.lon+180)/360*o),y:Math.floor((1-Math.log(Math.tan(a)+1/Math.cos(a))/Math.PI)/2*o)}}function ge(e,t){for(var a=[],o=e.x;o<=t.x;o++)for(var n=e.y;n<=t.y;n++)a.push({x:o,y:n});return a}var he="Are you sure you want to continue with download?",Oe=function(){var e=Object(O.b)(),t=Object(O.c)(U),a=Object(O.c)(J),n=Object(O.c)(A),l=Object(O.c)(P),r=Object(O.c)(Z),i=Object(o.useState)(!1),s=Object(c.a)(i,2),d=s[0],u=s[1],b=Object(o.useState)(he),j=Object(c.a)(b,2),p=j[0],g=j[1],h=Object(o.useState)(null),x=Object(c.a)(h,2),m=x[0],v=x[1];return Object(o.useEffect)((function(){t?re.b.info("Fetching Tiles!",{position:"top-right",hideProgressBar:!0,closeOnClick:!1,pauseOnHover:!0,draggable:!0,autoClose:!1,progress:void 0}):re.b.dismiss()}),[t]),Object(q.jsxs)(q.Fragment,{children:[Object(q.jsx)(_,{}),Object(q.jsx)(le,{onSubmit:function(e){var t=function(e,t,a,o){var n=pe(e,a),l=pe(t,a),r=Math.abs(n.x-l.x)+1,c=Math.abs(n.y-l.y)+1;return{upperLeftCoordinate:n,lowerRightCoordinate:l,zoom:a,xCount:r,yCount:c,style:o,numTiles:r*c,tiles:ge(n,l)}}(n,l,r,a);t&&(v(t),g("Are you sure you want to download ".concat(t.tiles.length," map tile files?")),u(!0))}}),Object(q.jsx)(re.a,{}),Object(q.jsx)(be,{onContinue:function(){u(!1),g(he),e(k()),e(S(m))},onDecline:function(){u(!1),g(he),e(F())},open:d,text:p})]})};var xe=function(){return Object(q.jsx)("div",{className:"App",children:Object(q.jsx)(Oe,{})})},me=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,281)).then((function(t){var a=t.getCLS,o=t.getFID,n=t.getFCP,l=t.getLCP,r=t.getTTFB;a(e),o(e),n(e),l(e),r(e)}))},ve=a(52),fe=function(e){return function(t){return function(a){console.group(a.type),console.info("dispatching",a);var o=t(a);return console.log("next state",e.getState()),console.groupEnd(),o}}},ye=Object(x.a)({reducer:{form:B},middleware:[ve.a,fe]});r.a.render(Object(q.jsx)(n.a.StrictMode,{children:Object(q.jsx)(O.a,{store:ye,children:Object(q.jsx)(xe,{})})}),document.getElementById("root")),me()}},[[197,1,2]]]);
//# sourceMappingURL=main.fd9315a9.chunk.js.map