(this["webpackJsonpmapbox-tiles"]=this["webpackJsonpmapbox-tiles"]||[]).push([[0],{115:function(e,t,o){},116:function(e,t,o){},161:function(e,t,o){"use strict";o.r(t);var a=o(0),n=o.n(a),l=o(17),r=o.n(l),c=(o(115),o(116),o(13)),s=o.n(c),i=o(65),d=o(86),u=o.n(d),b=(o(122),o(87)),j=o.n(b),g=o(238),p=o(233),h=o(14),x=o(47),O=o(51),m=o(89),v=o.n(m),f=o(95);const y=(e,t,o,a)=>256===t||512===t?"".concat("","/").concat(e,"/tiles/").concat(t,"/").concat(o,"/").concat(a.x,"/").concat(a.y,"?access_token=").concat(""):"".concat("","/").concat(e,"/tiles/512/").concat(o,"/").concat(a.x,"/").concat(a.y,"@2x?access_token=").concat(""),w=Object(x.b)("form/fetchTiles",(async(e,t)=>{const o=t.getState().form;console.info("Downloading ".concat(e.tiles.length," tiles"));const a=await Promise.allSettled(e.tiles.map((t=>v()({url:y(e.style,o.pixels,e.zoom,t),method:"GET",responseType:"blob"}).then((e=>new Promise(((t,o)=>{const a="mapbox-tile-".concat(Object(f.a)(10),".jpg"),n=window.URL.createObjectURL(new Blob([e.data])),l=document.createElement("a");l.href=n,l.setAttribute("download",a),document.body.appendChild(l),l.click(),o()})))))));return a.forEach((e=>{console.log(e)})),t.dispatch(L()),a})),C=Object(x.c)({name:"form",initialState:{upperLeftCoordinate:{lat:null,lon:null},lowerRightCoordinate:{lat:null,lon:null},zoomLevel:8,loading:!1,mapStyle:"satellite-streets-v11",pixels:512,error:null},reducers:{setLoadingToTrue:e=>{e.loading=!0},setLoadingToFalse:e=>{e.loading=!1},setUpperLeftCoordinate:(e,t)=>{e.upperLeftCoordinate=t.payload},setLowerRightCoordinate:(e,t)=>{e.lowerRightCoordinate=t.payload},setZoomLevel:(e,t)=>{e.zoomLevel=t.payload},setMapStyle:(e,t)=>{e.mapStyle=t.payload},setPixels:(e,t)=>{e.pixels=t.payload},setError:(e,t)=>{e.error=t.payload},clearError:e=>{e.error=null}},extraReducers:e=>{e.addCase(w.fulfilled,((e,t)=>{console.log("SUCCESS")}))}}),{setLoadingToTrue:S,setLoadingToFalse:L,setUpperLeftCoordinate:T,setLowerRightCoordinate:k,setZoomLevel:F,setMapStyle:E,setPixels:M}=C.actions,D=e=>e.form,R=Object(O.a)(D,(e=>e.mapStyle)),P=Object(O.a)(D,(e=>e.upperLeftCoordinate)),A=Object(O.a)(D,(e=>e.lowerRightCoordinate)),U=Object(O.a)(D,(e=>e.zoomLevel)),z=Object(O.a)(D,(e=>e.pixels)),B=Object(O.a)(D,(e=>e.loading));var I=C.reducer,q=o(71),_=o(2);s.a.workerClass=o(153).default;const N=[-93.16534986838542,44.96687220057306],G=Object(i.default)({accessToken:""}),J=()=>{const e=Object(h.c)(R),t=Object(h.c)(U),o=Object(h.b)();let n=Object(a.useRef)(null);Object(a.useEffect)((()=>{const e=e=>{e.isComposing||"Escape"!==e.key||n.current.draw.deleteAll()};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}}));const l=()=>{const{features:e}=n.current.draw.getAll();if(!e)return[null,null];const t={lat:e[0].geometry.coordinates[0][0][1],lon:e[0].geometry.coordinates[0][0][0]},a={lat:e[0].geometry.coordinates[0][2][1],lon:e[0].geometry.coordinates[0][2][0]};o(T(t)),o(k(a))};return Object(_.jsx)(g.a,{sx:{flexGrow:1},children:Object(_.jsxs)(p.a,{container:!0,spacing:2,children:[Object(_.jsx)(p.a,{item:!0,xs:11,children:Object(_.jsx)("h2",{children:"Mapbox Static Tile Downloader"})}),Object(_.jsx)(G,{style:"mapbox://styles/mapbox/".concat(e),containerStyle:{height:"700px",width:"96vw",marginLeft:"2vw",marginBottom:"2vw"},center:N,zoom:[t],children:Object(_.jsx)(u.a,{ref:n,controls:{polygon:!0,trash:!0},displayControlsDefault:!1,onDrawCreate:()=>{const e=n.current.draw.getAll();n.current.draw.getAll().features.length>1&&n.current.draw.delete(e.features[0].id),l()},onDrawUpdate:()=>{l()},onDrawDelete:()=>{o(T({lat:null,lon:null})),o(k({lat:null,lon:null}))},onDrawSelectionChange:()=>{n.current.draw.getSelected().features.length>0&&n.current.draw.changeMode("tx_rect",{featureId:n.current.draw.getSelected().features[0].id,scaleCenter:q.a.Opposite,canRotate:!1})},modes:{draw_polygon:j.a,tx_rect:q.b}})})]})})};var Z=o(227),V=o(230),H=o(226),K=o(231),Q=o(165),W=o(234),X=o(93),Y=o.n(X);const $=e=>{const t=e.lat?String(e.lat):null,o=e.lon?String(e.lon):null;return t&&o?"[ ".concat(parseFloat(t).toFixed(5),", ").concat(parseFloat(o).toFixed(5)," ]"):""},ee=e=>{try{const t=JSON.parse(e);return{lat:t[0],lon:t[1]}}catch(t){return null}},te=e=>256===e||512===e||1024===e;function oe(e){let{onSubmit:t}=e;const o=Object(h.b)(),n=Object(h.c)(R),l=Object(h.c)(P),r=Object(h.c)(A),c=Object(h.c)(U),s=Object(h.c)(z),i=Object(h.c)(B),[d,u]=Object(a.useState)($(l)),[b,j]=Object(a.useState)($(r)),[p,x]=Object(a.useState)(String(s));Object(a.useEffect)((()=>{u($(l)),j($(r))}),[l,r]),Object(a.useEffect)((()=>{x(s)}),[s]);return Object(_.jsxs)(a.Fragment,{children:[Object(_.jsxs)(g.a,{component:"form",sx:{"& > :not(style)":{m:1,width:"30ch"}},noValidate:!0,autoComplete:"off",style:{marginTop:"20px"},children:[Object(_.jsx)(Z.a,{required:!0,id:"outlined-required",label:"Upper Left Coordinates",value:d,onChange:e=>{u(e.target.value);const t=ee(e.target.value);t&&o(T(t))},error:!ee(d),disabled:i}),Object(_.jsx)(Z.a,{required:!0,id:"outlined-required",label:"Lower Right Coordinates",value:b,onChange:e=>{j(e.target.value);const t=ee(e.target.value);t&&o(k(t))},error:!ee(b),disabled:i}),Object(_.jsx)(Z.a,{id:"outlined-required",label:"Tile Size in Pixels Squared",value:p,error:!te(Number.parseFloat(p)),onChange:e=>{x(e.target.value);const t=Number.parseFloat(e.target.value);te(t)&&o(M(t))},disabled:i}),Object(_.jsxs)(H.a,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:n,onChange:e=>{o(E(e.target.value))},disabled:i,style:{marginTop:"8px"},children:[Object(_.jsx)(K.a,{value:"streets-v11",children:"streets-v11"}),Object(_.jsx)(K.a,{value:"outdoors-v11",children:"outdoors-v11"}),Object(_.jsx)(K.a,{value:"light-v10",children:"light-v10"}),Object(_.jsx)(K.a,{value:"dark-v10",children:"dark-v10"}),Object(_.jsx)(K.a,{value:"satellite-v9",children:"satellite-v9"}),Object(_.jsx)(K.a,{value:"satellite-streets-v11",children:"satellite-streets-v11"}),Object(_.jsx)(K.a,{value:"navigation-day-v1",children:"navigation-day-v1"}),Object(_.jsx)(K.a,{value:"navigation-night-v1",children:"navigation-night-v1"})]}),Object(_.jsxs)(g.a,{sx:{width:320},style:{marginLeft:"auto",marginRight:"auto",marginTop:"20px"},children:[Object(_.jsx)(Q.a,{gutterBottom:!0,children:"Tile Zoom Level"}),Object(_.jsx)(V.a,{"aria-label":"slider",defaultValue:8,valueLabelDisplay:"on",min:1,max:17,step:1,style:{marginTop:"45px"},onChange:e=>{o(F(e.target.value))},onClick:()=>{o(F(1)),o(F(c))},disabled:i})]})]}),Object(_.jsx)(W.a,{variant:"contained",color:"primary",startIcon:Object(_.jsx)(Y.a,{}),onClick:t,style:{marginTop:"45px",marginBottom:"100px"},disabled:i||!te(s)||!ee(d)||!ee(b),children:"Download Tiles"})]})}var ae=o(57),ne=(o(159),o(235)),le=o(241),re=o(239),ce=o(240),se=o(225);function ie(e){let{open:t,onContinue:o,onDecline:a,text:n}=e;return Object(_.jsx)("div",{children:Object(_.jsxs)(ne.a,{open:t,onClose:a,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[Object(_.jsx)(se.a,{id:"alert-dialog-title",children:"Use Google's location service?"}),Object(_.jsx)(re.a,{children:Object(_.jsx)(ce.a,{id:"alert-dialog-description",children:n})}),Object(_.jsxs)(le.a,{children:[Object(_.jsx)(W.a,{onClick:a,children:"Cancel"}),Object(_.jsx)(W.a,{onClick:o,autoFocus:!0,children:"Continue"})]})]})})}const de=Math.PI/180;function ue(e,t){const o=de*e.lat;console.log(e);const a=Math.pow(2,t);return{x:Math.floor((e.lon+180)/360*a),y:Math.floor((1-Math.log(Math.tan(o)+1/Math.cos(o))/Math.PI)/2*a)}}function be(e,t){const o=[];for(let a=e.x;a<=t.x;a++)for(let n=e.y;n<=t.y;n++)o.push({x:a,y:n});return o}const je="Are you sure you want to continue with download?",ge=()=>{const e=Object(h.b)(),t=Object(h.c)(B),o=Object(h.c)(R),n=Object(h.c)(P),l=Object(h.c)(A),r=Object(h.c)(U),[c,s]=Object(a.useState)(!1),[i,d]=Object(a.useState)(je),[u,b]=Object(a.useState)(null);return Object(a.useEffect)((()=>{t?ae.b.info("Fetching Tiles!",{position:"top-right",hideProgressBar:!0,closeOnClick:!1,pauseOnHover:!0,draggable:!0,autoClose:!1,progress:void 0}):ae.b.dismiss()}),[t]),Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(J,{}),Object(_.jsx)(oe,{onSubmit:e=>{const t=function(e,t,o,a){const n=ue(e,o),l=ue(t,o),r=Math.abs(n.x-l.x)+1,c=Math.abs(n.y-l.y)+1;return{upperLeftCoordinate:n,lowerRightCoordinate:l,zoom:o,xCount:r,yCount:c,style:a,numTiles:r*c,tiles:be(n,l)}}(n,l,r,o);t&&(b(t),d("Are you sure you want to download ".concat(t.tiles.length," map tile files?")),s(!0))}}),Object(_.jsx)(ae.a,{}),Object(_.jsx)(ie,{onContinue:()=>{s(!1),d(je),e(S()),e(w(u))},onDecline:()=>{s(!1),d(je),e(L())},open:c,text:i})]})};var pe=function(){return Object(_.jsx)("div",{className:"App",children:Object(_.jsx)(ge,{})})};var he=e=>{e&&e instanceof Function&&o.e(3).then(o.bind(null,245)).then((t=>{let{getCLS:o,getFID:a,getFCP:n,getLCP:l,getTTFB:r}=t;o(e),a(e),n(e),l(e),r(e)}))},xe=o(44);var Oe=e=>t=>o=>{console.group(o.type),console.info("dispatching",o);let a=t(o);return console.log("next state",e.getState()),console.groupEnd(),a};const me=Object(x.a)({reducer:{form:I},middleware:[xe.a,Oe]});r.a.render(Object(_.jsx)(n.a.StrictMode,{children:Object(_.jsx)(h.a,{store:me,children:Object(_.jsx)(pe,{})})}),document.getElementById("root")),he()}},[[161,1,2]]]);
//# sourceMappingURL=main.74d36811.chunk.js.map