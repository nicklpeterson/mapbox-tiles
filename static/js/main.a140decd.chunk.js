(this["webpackJsonpmapbox-tiles"]=this["webpackJsonpmapbox-tiles"]||[]).push([[0],{155:function(e,t,n){},156:function(e,t,n){},212:function(e,t,n){"use strict";n.r(t);var o=n(0),a=n.n(o),r=n(19),c=n.n(r),i=(n(155),n(156),n(12)),l=n(88),s=n(123),u=n.n(s),d=(n(175),n(124)),b=n.n(d),j=n(293),f=n(288),p=n(17),g=n(92),h=n.n(g),v=n(125),O=n(64),x=n(71),m=n(126),y=n.n(m),w=n(133),C=function(e,t,n,o){return"".concat("https://api.mapbox.com/styles/v1/mapbox","/").concat(e,"/tiles/").concat(t,"/").concat(n,"/").concat(o.x,"/").concat(o.y,"?access_token=").concat("pk.eyJ1IjoiZmFrZXVzZXJnaXRodWIiLCJhIjoiY2pwOGlneGI4MDNnaDN1c2J0eW5zb2ZiNyJ9.mALv0tCpbYUPtzT7YysA2g")},L=Object(O.b)("form/fetchTiles",function(){var e=Object(v.a)(h.a.mark((function e(t,n){var o,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=n.getState().form,console.info("Downloading ".concat(t.tiles.length," tiles")),e.next=4,Promise.allSettled(t.tiles.map((function(e){return y()({url:C(t.style,o.pixels,t.zoom,e),method:"GET",responseType:"blob"}).then((function(e){return new Promise((function(t,n){var o="mapbox-tile-".concat(Object(w.a)(10),".jpg"),a=window.URL.createObjectURL(new Blob([e.data])),r=document.createElement("a");r.href=a,r.setAttribute("download",o),document.body.appendChild(r),r.click(),n()}))}))})));case 4:return(a=e.sent).forEach((function(e){return console.log(e)})),n.dispatch(F()),e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),S=Object(O.c)({name:"form",initialState:{upperLeftCoordinate:{lat:null,lon:null},lowerRightCoordinate:{lat:null,lon:null},zoomLevel:8,loading:!1,mapStyle:"satellite-streets-v11",pixels:512,error:null},reducers:{setLoadingToTrue:function(e){e.loading=!0},setLoadingToFalse:function(e){e.loading=!1},setUpperLeftCoordinate:function(e,t){e.upperLeftCoordinate=t.payload},setLowerRightCoordinate:function(e,t){e.lowerRightCoordinate=t.payload},setZoomLevel:function(e,t){e.zoomLevel=t.payload},setMapStyle:function(e,t){e.mapStyle=t.payload},setPixels:function(e,t){e.pixels=t.payload},setError:function(e,t){e.error=t.payload},clearError:function(e){e.error=null}},extraReducers:function(e){e.addCase(L.fulfilled,(function(e,t){console.log("SUCCESS")}))}}),T=S.actions,k=T.setLoadingToTrue,F=T.setLoadingToFalse,D=T.setUpperLeftCoordinate,M=T.setLowerRightCoordinate,E=T.setZoomLevel,I=T.setMapStyle,R=T.setPixels,z=function(e){return e.form},J=Object(x.a)(z,(function(e){return e.mapStyle})),A=Object(x.a)(z,(function(e){return e.upperLeftCoordinate})),P=Object(x.a)(z,(function(e){return e.lowerRightCoordinate})),Z=Object(x.a)(z,(function(e){return e.zoomLevel})),N=Object(x.a)(z,(function(e){return e.pixels})),U=Object(x.a)(z,(function(e){return e.loading})),B=S.reducer,G=n(95),q=n(2),X=[-93.16534986838542,44.96687220057306],Y=Object(l.default)({accessToken:"pk.eyJ1IjoiZmFrZXVzZXJnaXRodWIiLCJhIjoiY2pwOGlneGI4MDNnaDN1c2J0eW5zb2ZiNyJ9.mALv0tCpbYUPtzT7YysA2g"}),V=function(){var e=Object(p.c)(J),t=Object(p.c)(Z),n=Object(p.b)(),a=Object(o.useRef)(null);Object(o.useEffect)((function(){var e=function(e){e.isComposing||"Escape"!==e.key||a.current.draw.deleteAll()};return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}}));var r=function(){var e=a.current.draw.getAll().features;if(!e)return[null,null];var t={lat:e[0].geometry.coordinates[0][0][1],lon:e[0].geometry.coordinates[0][0][0]},o={lat:e[0].geometry.coordinates[0][2][1],lon:e[0].geometry.coordinates[0][2][0]};n(D(t)),n(M(o))};return Object(q.jsx)(j.a,{sx:{flexGrow:1},children:Object(q.jsxs)(f.a,{container:!0,spacing:2,children:[Object(q.jsx)(f.a,{item:!0,xs:11,children:Object(q.jsx)("h2",{children:"Mapbox Static Tile Downloader"})}),Object(q.jsx)(Y,{style:"mapbox://styles/mapbox/".concat(e),containerStyle:{height:"700px",width:"96vw",marginLeft:"2vw",marginBottom:"2vw"},center:X,zoom:[t],children:Object(q.jsx)(u.a,{ref:a,controls:{polygon:!0,trash:!0},displayControlsDefault:!1,onDrawCreate:function(){var e=a.current.draw.getAll();a.current.draw.getAll().features.length>1&&a.current.draw.delete(e.features[0].id),r()},onDrawUpdate:function(){r()},onDrawDelete:function(){n(D({lat:null,lon:null})),n(M({lat:null,lon:null}))},onDrawSelectionChange:function(){a.current.draw.getSelected().features.length>0&&a.current.draw.changeMode("tx_rect",{featureId:a.current.draw.getSelected().features[0].id,scaleCenter:G.a.Opposite,canRotate:!1})},modes:{draw_polygon:b.a,tx_rect:G.b}})})]})})},W=n(281),_=n(285),H=n(217),K=n(286),Q=n(131),$=n.n(Q),ee=n(280),te=n(284),ne=function(e){var t=e.lat?String(e.lat):null,n=e.lon?String(e.lon):null;return t&&n?"[ ".concat(parseFloat(t).toFixed(5),", ").concat(parseFloat(n).toFixed(5)," ]"):""},oe=function(e){try{var t=JSON.parse(e);return{lat:t[0],lon:t[1]}}catch(n){return null}},ae=function(e){return 256===e||512===e||1024===e};function re(e){var t=e.onSubmit,n=Object(p.b)(),a=Object(p.c)(J),r=Object(p.c)(A),c=Object(p.c)(P),l=Object(p.c)(Z),s=Object(p.c)(N),u=Object(p.c)(U),d=Object(o.useState)(ne(r)),b=Object(i.a)(d,2),f=b[0],g=b[1],h=Object(o.useState)(ne(c)),v=Object(i.a)(h,2),O=v[0],x=v[1],m=Object(o.useState)(String(s)),y=Object(i.a)(m,2),w=y[0],C=y[1];Object(o.useEffect)((function(){g(ne(r)),x(ne(c))}),[r,c]),Object(o.useEffect)((function(){C(s)}),[s]);return Object(q.jsxs)(o.Fragment,{children:[Object(q.jsxs)(j.a,{component:"form",sx:{width:"96vw","& > :not(style)":{m:1,width:"30ch"}},noValidate:!0,autoComplete:"off",style:{marginTop:"20px"},children:[Object(q.jsx)(W.a,{required:!0,id:"outlined-required",label:"Upper Left Coordinates",value:f,onChange:function(e){g(e.target.value);var t=oe(e.target.value);t&&n(D(t))},error:!oe(f),disabled:u}),Object(q.jsx)(W.a,{required:!0,id:"outlined-required",label:"Lower Right Coordinates",value:O,onChange:function(e){x(e.target.value);var t=oe(e.target.value);t&&n(M(t))},error:!oe(O),disabled:u}),Object(q.jsx)(W.a,{id:"outlined-required",label:"Tile Size in Pixels Squared",value:w,error:!ae(Number.parseFloat(w)),onChange:function(e){C(e.target.value);var t=Number.parseFloat(e.target.value);ae(t)&&n(R(t))},disabled:u}),Object(q.jsxs)(ee.a,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:a,onChange:function(e){n(I(e.target.value))},disabled:u,style:{marginTop:"8px"},children:[Object(q.jsx)(te.a,{value:"streets-v11",children:"streets-v11"}),Object(q.jsx)(te.a,{value:"outdoors-v11",children:"outdoors-v11"}),Object(q.jsx)(te.a,{value:"light-v10",children:"light-v10"}),Object(q.jsx)(te.a,{value:"dark-v10",children:"dark-v10"}),Object(q.jsx)(te.a,{value:"satellite-v9",children:"satellite-v9"}),Object(q.jsx)(te.a,{value:"satellite-streets-v11",children:"satellite-streets-v11"}),Object(q.jsx)(te.a,{value:"navigation-day-v1",children:"navigation-day-v1"}),Object(q.jsx)(te.a,{value:"navigation-night-v1",children:"navigation-night-v1"})]}),Object(q.jsxs)(j.a,{sx:{width:320},style:{marginLeft:"auto",marginRight:"auto",marginTop:"20px"},children:[Object(q.jsx)(H.a,{gutterBottom:!0,children:"Tile Zoom Level"}),Object(q.jsx)(_.a,{"aria-label":"slider",defaultValue:8,valueLabelDisplay:"on",min:1,max:17,step:1,style:{marginTop:"45px"},onChange:function(e){n(E(e.target.value))},onClick:function(){n(E(1)),n(E(l))},disabled:u})]})]}),Object(q.jsx)(K.a,{variant:"contained",color:"primary",startIcon:Object(q.jsx)($.a,{}),onClick:t,style:{marginTop:"45px",marginBottom:"100px"},disabled:u||!ae(s)||!oe(f)||!oe(O),children:"Download Tiles"})]})}var ce=n(78),ie=(n(211),n(290)),le=n(289),se=n(296),ue=n(294),de=n(295),be=n(279);function je(e){var t=e.open,n=e.onContinue,o=e.onDecline,a=e.text;return Object(q.jsx)("div",{children:Object(q.jsxs)(le.a,{open:t,onClose:o,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[Object(q.jsx)(be.a,{id:"alert-dialog-title",children:"Use Google's location service?"}),Object(q.jsx)(ue.a,{children:Object(q.jsx)(de.a,{id:"alert-dialog-description",children:a})}),Object(q.jsxs)(se.a,{children:[Object(q.jsx)(ie.a,{onClick:o,children:"Cancel"}),Object(q.jsx)(ie.a,{onClick:n,autoFocus:!0,children:"Continue"})]})]})})}var fe=Math.PI/180;function pe(e,t){var n=fe*e.lat;console.log(e);var o=Math.pow(2,t);return{x:Math.floor((e.lon+180)/360*o),y:Math.floor((1-Math.log(Math.tan(n)+1/Math.cos(n))/Math.PI)/2*o)}}function ge(e,t){for(var n=[],o=e.x;o<=t.x;o++)for(var a=e.y;a<=t.y;a++)n.push({x:o,y:a});return n}var he="Are you sure you want to continue with download?",ve=function(){var e=Object(p.b)(),t=Object(p.c)(U),n=Object(p.c)(J),a=Object(p.c)(A),r=Object(p.c)(P),c=Object(p.c)(Z),l=Object(o.useState)(!1),s=Object(i.a)(l,2),u=s[0],d=s[1],b=Object(o.useState)(he),j=Object(i.a)(b,2),f=j[0],g=j[1],h=Object(o.useState)(null),v=Object(i.a)(h,2),O=v[0],x=v[1];return Object(o.useEffect)((function(){t?ce.b.info("Fetching Tiles!",{position:"top-right",hideProgressBar:!0,closeOnClick:!1,pauseOnHover:!0,draggable:!0,autoClose:!1,progress:void 0}):ce.b.dismiss()}),[t]),Object(q.jsxs)(q.Fragment,{children:[Object(q.jsx)(V,{}),Object(q.jsx)(re,{onSubmit:function(e){var t=function(e,t,n,o){var a=pe(e,n),r=pe(t,n),c=Math.abs(a.x-r.x)+1,i=Math.abs(a.y-r.y)+1;return{upperLeftCoordinate:a,lowerRightCoordinate:r,zoom:n,xCount:c,yCount:i,style:o,numTiles:c*i,tiles:ge(a,r)}}(a,r,c,n);t&&(x(t),g("Are you sure you want to download ".concat(t.tiles.length," map tile files?")),d(!0))}}),Object(q.jsx)(ce.a,{}),Object(q.jsx)(je,{onContinue:function(){d(!1),g(he),e(k()),e(L(O))},onDecline:function(){d(!1),g(he),e(F())},open:u,text:f})]})};var Oe=function(){return Object(q.jsx)("div",{className:"App",children:Object(q.jsx)(ve,{})})},xe=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,301)).then((function(t){var n=t.getCLS,o=t.getFID,a=t.getFCP,r=t.getLCP,c=t.getTTFB;n(e),o(e),a(e),r(e),c(e)}))},me=n(60),ye=function(e){return function(t){return function(n){console.group(n.type),console.info("dispatching",n);var o=t(n);return console.log("next state",e.getState()),console.groupEnd(),o}}},we=Object(O.a)({reducer:{form:B},middleware:[me.a,ye]});c.a.render(Object(q.jsx)(a.a.StrictMode,{children:Object(q.jsx)(p.a,{store:we,children:Object(q.jsx)(Oe,{})})}),document.getElementById("root")),xe()}},[[212,1,2]]]);
//# sourceMappingURL=main.a140decd.chunk.js.map