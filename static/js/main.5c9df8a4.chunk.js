(this["webpackJsonpmapbox-tiles"]=this["webpackJsonpmapbox-tiles"]||[]).push([[0],{155:function(e,t,n){},156:function(e,t,n){},213:function(e,t,n){"use strict";n.r(t);var o=n(0),a=n.n(o),r=n(19),l=n.n(r),c=(n(155),n(156),n(13)),i=n(17),s=n.n(i),u=n(88),d=n(123),b=n.n(d),j=(n(175),n(124)),p=n.n(j),g=n(294),f=n(289),h=n(18),O=n(92),x=n.n(O),m=n(125),v=n(64),y=n(71),w=n(126),C=n.n(w),L=n(133),S=function(e,t,n,o){return"".concat("https://api.mapbox.com/styles/v1/mapbox","/").concat(e,"/tiles/").concat(t,"/").concat(n,"/").concat(o.x,"/").concat(o.y,"?access_token=").concat("pk.eyJ1IjoiZmFrZXVzZXJnaXRodWIiLCJhIjoiY2pwOGlneGI4MDNnaDN1c2J0eW5zb2ZiNyJ9.mALv0tCpbYUPtzT7YysA2g")},T=Object(v.b)("form/fetchTiles",function(){var e=Object(m.a)(x.a.mark((function e(t,n){var o,a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=n.getState().form,console.info("Downloading ".concat(t.tiles.length," tiles")),e.next=4,Promise.allSettled(t.tiles.map((function(e){return C()({url:S(t.style,o.pixels,t.zoom,e),method:"GET",responseType:"blob"}).then((function(e){return new Promise((function(t,n){var o="mapbox-tile-".concat(Object(L.a)(10),".jpg"),a=window.URL.createObjectURL(new Blob([e.data])),r=document.createElement("a");r.href=a,r.setAttribute("download",o),document.body.appendChild(r),r.click(),n()}))}))})));case 4:return(a=e.sent).forEach((function(e){return console.log(e)})),n.dispatch(M()),e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),k=Object(v.c)({name:"form",initialState:{upperLeftCoordinate:{lat:null,lon:null},lowerRightCoordinate:{lat:null,lon:null},zoomLevel:8,loading:!1,mapStyle:"satellite-streets-v11",pixels:512,error:null},reducers:{setLoadingToTrue:function(e){e.loading=!0},setLoadingToFalse:function(e){e.loading=!1},setUpperLeftCoordinate:function(e,t){e.upperLeftCoordinate=t.payload},setLowerRightCoordinate:function(e,t){e.lowerRightCoordinate=t.payload},setZoomLevel:function(e,t){e.zoomLevel=t.payload},setMapStyle:function(e,t){e.mapStyle=t.payload},setPixels:function(e,t){e.pixels=t.payload},setError:function(e,t){e.error=t.payload},clearError:function(e){e.error=null}},extraReducers:function(e){e.addCase(T.fulfilled,(function(e,t){console.log("SUCCESS")}))}}),F=k.actions,D=F.setLoadingToTrue,M=F.setLoadingToFalse,R=F.setUpperLeftCoordinate,E=F.setLowerRightCoordinate,I=F.setZoomLevel,z=F.setMapStyle,J=F.setPixels,A=function(e){return e.form},P=Object(y.a)(A,(function(e){return e.mapStyle})),Z=Object(y.a)(A,(function(e){return e.upperLeftCoordinate})),N=Object(y.a)(A,(function(e){return e.lowerRightCoordinate})),U=Object(y.a)(A,(function(e){return e.zoomLevel})),B=Object(y.a)(A,(function(e){return e.pixels})),G=Object(y.a)(A,(function(e){return e.loading})),q=k.reducer,X=n(95),Y=n(2);s.a.workerClass=n(207).default;const V=[-93.16534986838542,44.96687220057306],W=Object(u.default)({accessToken:"pk.eyJ1IjoiZmFrZXVzZXJnaXRodWIiLCJhIjoiY2pwOGlneGI4MDNnaDN1c2J0eW5zb2ZiNyJ9.mALv0tCpbYUPtzT7YysA2g"}),_=()=>{const e=Object(h.c)(P),t=Object(h.c)(U),n=Object(h.b)();let a=Object(o.useRef)(null);Object(o.useEffect)((()=>{const e=e=>{e.isComposing||"Escape"!==e.key||a.current.draw.deleteAll()};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}}));const r=()=>{const{features:e}=a.current.draw.getAll();if(!e)return[null,null];const t={lat:e[0].geometry.coordinates[0][0][1],lon:e[0].geometry.coordinates[0][0][0]},o={lat:e[0].geometry.coordinates[0][2][1],lon:e[0].geometry.coordinates[0][2][0]};n(R(t)),n(E(o))};return Object(Y.jsx)(g.a,{sx:{flexGrow:1},children:Object(Y.jsxs)(f.a,{container:!0,spacing:2,children:[Object(Y.jsx)(f.a,{item:!0,xs:11,children:Object(Y.jsx)("h2",{children:"Mapbox Static Tile Downloader"})}),Object(Y.jsx)(W,{style:"mapbox://styles/mapbox/".concat(e),containerStyle:{height:"700px",width:"96vw",marginLeft:"2vw",marginBottom:"2vw"},center:V,zoom:[t],children:Object(Y.jsx)(b.a,{ref:a,controls:{polygon:!0,trash:!0},displayControlsDefault:!1,onDrawCreate:()=>{const e=a.current.draw.getAll();a.current.draw.getAll().features.length>1&&a.current.draw.delete(e.features[0].id),r()},onDrawUpdate:()=>{r()},onDrawDelete:()=>{n(R({lat:null,lon:null})),n(E({lat:null,lon:null}))},onDrawSelectionChange:()=>{a.current.draw.getSelected().features.length>0&&a.current.draw.changeMode("tx_rect",{featureId:a.current.draw.getSelected().features[0].id,scaleCenter:X.a.Opposite,canRotate:!1})},modes:{draw_polygon:p.a,tx_rect:X.b}})})]})})};var H=n(282),K=n(286),Q=n(218),$=n(287),ee=n(131),te=n.n(ee),ne=n(281),oe=n(285);const ae=e=>{const t=e.lat?String(e.lat):null,n=e.lon?String(e.lon):null;return t&&n?"[ ".concat(parseFloat(t).toFixed(5),", ").concat(parseFloat(n).toFixed(5)," ]"):""},re=e=>{try{const t=JSON.parse(e);return{lat:t[0],lon:t[1]}}catch(t){return null}},le=e=>256===e||512===e||1024===e;function ce(e){let{onSubmit:t}=e;const n=Object(h.b)(),a=Object(h.c)(P),r=Object(h.c)(Z),l=Object(h.c)(N),c=Object(h.c)(U),i=Object(h.c)(B),s=Object(h.c)(G),[u,d]=Object(o.useState)(ae(r)),[b,j]=Object(o.useState)(ae(l)),[p,f]=Object(o.useState)(String(i));Object(o.useEffect)((()=>{d(ae(r)),j(ae(l))}),[r,l]),Object(o.useEffect)((()=>{f(i)}),[i]);return Object(Y.jsxs)(o.Fragment,{children:[Object(Y.jsxs)(g.a,{component:"form",sx:{width:"96vw","& > :not(style)":{m:1,width:"30ch"}},noValidate:!0,autoComplete:"off",style:{marginTop:"20px"},children:[Object(Y.jsx)(H.a,{required:!0,id:"outlined-required",label:"Upper Left Coordinates",value:u,onChange:e=>{d(e.target.value);const t=re(e.target.value);t&&n(R(t))},error:!re(u),disabled:s}),Object(Y.jsx)(H.a,{required:!0,id:"outlined-required",label:"Lower Right Coordinates",value:b,onChange:e=>{j(e.target.value);const t=re(e.target.value);t&&n(E(t))},error:!re(b),disabled:s}),Object(Y.jsx)(H.a,{id:"outlined-required",label:"Tile Size in Pixels Squared",value:p,error:!le(Number.parseFloat(p)),onChange:e=>{f(e.target.value);const t=Number.parseFloat(e.target.value);le(t)&&n(J(t))},disabled:s}),Object(Y.jsxs)(ne.a,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:a,onChange:e=>{n(z(e.target.value))},disabled:s,style:{marginTop:"8px"},children:[Object(Y.jsx)(oe.a,{value:"streets-v11",children:"streets-v11"}),Object(Y.jsx)(oe.a,{value:"outdoors-v11",children:"outdoors-v11"}),Object(Y.jsx)(oe.a,{value:"light-v10",children:"light-v10"}),Object(Y.jsx)(oe.a,{value:"dark-v10",children:"dark-v10"}),Object(Y.jsx)(oe.a,{value:"satellite-v9",children:"satellite-v9"}),Object(Y.jsx)(oe.a,{value:"satellite-streets-v11",children:"satellite-streets-v11"}),Object(Y.jsx)(oe.a,{value:"navigation-day-v1",children:"navigation-day-v1"}),Object(Y.jsx)(oe.a,{value:"navigation-night-v1",children:"navigation-night-v1"})]}),Object(Y.jsxs)(g.a,{sx:{width:320},style:{marginLeft:"auto",marginRight:"auto",marginTop:"20px"},children:[Object(Y.jsx)(Q.a,{gutterBottom:!0,children:"Tile Zoom Level"}),Object(Y.jsx)(K.a,{"aria-label":"slider",defaultValue:8,valueLabelDisplay:"on",min:1,max:17,step:1,style:{marginTop:"45px"},onChange:e=>{n(I(e.target.value))},onClick:()=>{n(I(1)),n(I(c))},disabled:s})]})]}),Object(Y.jsx)($.a,{variant:"contained",color:"primary",startIcon:Object(Y.jsx)(te.a,{}),onClick:t,style:{marginTop:"45px",marginBottom:"100px",marginRight:"90px"},disabled:s||!le(i)||!re(u)||!re(b),children:"Download Tiles"})]})}var ie=n(78),se=(n(212),n(291)),ue=n(290),de=n(297),be=n(295),je=n(296),pe=n(280);function ge(e){var t=e.open,n=e.onContinue,o=e.onDecline,a=e.text;return Object(Y.jsx)("div",{children:Object(Y.jsxs)(ue.a,{open:t,onClose:o,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[Object(Y.jsx)(pe.a,{id:"alert-dialog-title",children:"Use Google's location service?"}),Object(Y.jsx)(be.a,{children:Object(Y.jsx)(je.a,{id:"alert-dialog-description",children:a})}),Object(Y.jsxs)(de.a,{children:[Object(Y.jsx)(se.a,{onClick:o,children:"Cancel"}),Object(Y.jsx)(se.a,{onClick:n,autoFocus:!0,children:"Continue"})]})]})})}var fe=Math.PI/180;function he(e,t){var n=fe*e.lat;console.log(e);var o=Math.pow(2,t);return{x:Math.floor((e.lon+180)/360*o),y:Math.floor((1-Math.log(Math.tan(n)+1/Math.cos(n))/Math.PI)/2*o)}}function Oe(e,t){for(var n=[],o=e.x;o<=t.x;o++)for(var a=e.y;a<=t.y;a++)n.push({x:o,y:a});return n}var xe="Are you sure you want to continue with download?",me=function(){var e=Object(h.b)(),t=Object(h.c)(G),n=Object(h.c)(P),a=Object(h.c)(Z),r=Object(h.c)(N),l=Object(h.c)(U),i=Object(o.useState)(!1),s=Object(c.a)(i,2),u=s[0],d=s[1],b=Object(o.useState)(xe),j=Object(c.a)(b,2),p=j[0],g=j[1],f=Object(o.useState)(null),O=Object(c.a)(f,2),x=O[0],m=O[1];return Object(o.useEffect)((function(){t?ie.b.info("Fetching Tiles!",{position:"top-right",hideProgressBar:!0,closeOnClick:!1,pauseOnHover:!0,draggable:!0,autoClose:!1,progress:void 0}):ie.b.dismiss()}),[t]),Object(Y.jsxs)(Y.Fragment,{children:[Object(Y.jsx)(_,{}),Object(Y.jsx)(ce,{onSubmit:function(e){var t=function(e,t,n,o){var a=he(e,n),r=he(t,n),l=Math.abs(a.x-r.x)+1,c=Math.abs(a.y-r.y)+1;return{upperLeftCoordinate:a,lowerRightCoordinate:r,zoom:n,xCount:l,yCount:c,style:o,numTiles:l*c,tiles:Oe(a,r)}}(a,r,l,n);t&&(m(t),g("Are you sure you want to download ".concat(t.tiles.length," map tile files?")),d(!0))}}),Object(Y.jsx)(ie.a,{}),Object(Y.jsx)(ge,{onContinue:function(){d(!1),g(xe),e(D()),e(T(x))},onDecline:function(){d(!1),g(xe),e(M())},open:u,text:p})]})};var ve=function(){return Object(Y.jsx)("div",{className:"App",children:Object(Y.jsx)(me,{})})},ye=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,302)).then((function(t){var n=t.getCLS,o=t.getFID,a=t.getFCP,r=t.getLCP,l=t.getTTFB;n(e),o(e),a(e),r(e),l(e)}))},we=n(60),Ce=function(e){return function(t){return function(n){console.group(n.type),console.info("dispatching",n);var o=t(n);return console.log("next state",e.getState()),console.groupEnd(),o}}},Le=Object(v.a)({reducer:{form:q},middleware:[we.a,Ce]});l.a.render(Object(Y.jsx)(a.a.StrictMode,{children:Object(Y.jsx)(h.a,{store:Le,children:Object(Y.jsx)(ve,{})})}),document.getElementById("root")),ye()}},[[213,1,2]]]);
//# sourceMappingURL=main.5c9df8a4.chunk.js.map